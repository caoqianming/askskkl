(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/question/answer"],{"197c":function(t,e,n){"use strict";n.r(e);var s=n("abca"),o=n.n(s);for(var i in s)"default"!==i&&function(t){n.d(e,t,function(){return s[t]})}(i);e["default"]=o.a},3087:function(t,e,n){"use strict";(function(t){n("ee7b"),n("921b");s(n("66fd"));var e=s(n("3653"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},3653:function(t,e,n){"use strict";n.r(e);var s=n("9c89"),o=n("197c");for(var i in o)"default"!==i&&function(t){n.d(e,t,function(){return o[t]})}(i);n("f0f4");var a=n("2877"),r=Object(a["a"])(o["default"],s["a"],s["b"],!1,null,null,null);e["default"]=r.exports},"9c89":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return o})},abca:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n("2f62"),o=i(n("2e85"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),s.forEach(function(e){r(t,e,n[e])})}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={computed:a({},(0,s.mapState)(["userInfo","hasLogin","system_config"])),data:function(){return{sort:"DESC",sort_key:"add_time",CommentInput:!1,page:0,InputBottom:0,isCard:!0,listData:[],Comments:[],Answer:[],question_info:[],answer_id:0,question_id:0,isLoad:!1,reload:!1,isLastPage:!1,commentDisabled:!1,textareaHeight:100,showCommentList:!1,answer_idx:-1}},onLoad:function(t){var e=t.answer_id,n=t.question_id;e&&(this.answer_id=e),n&&(this.question_id=n),t.idx&&(this.answer_idx=t.idx),this.getQuestionAnswer()},onShareAppMessage:function(t){"button"===t.from&&console.log(t.target);var e=this.question_info.question_content?this.question_info.question_content:"这个问题终于有回答了！";return{title:e}},onPullDownRefresh:function(){this.intGetList()},onReachBottom:function(){},methods:{toPeople:function(e){console.log("toPeople",e);var n=e.currentTarget.dataset.uid;if(n>0)t.navigateTo({url:"../people/people?uid="+n});else{var s=e.currentTarget.dataset.anonymous;1!=s&&o.default.showToast("会员ID有误")}},answer_vote:function(t){var e=this,n=this.userInfo;if(!n.uid||n.uid<1||!this.hasLogin)return this.toLogin(),!1;if(t==this.Answer.agree_status)return o.default.errorToast("你已经投票过了"),!1;var s={};s.access_token=n.access_token?n.access_token:"",s.answer_id=this.answer_id,s.agree_status=t,this.$api.answer_vote(s).then(function(n){1==t?(e.Answer.agree_count=e.Answer.agree_count+1,-1==e.Answer.agree_status&&(e.Answer.against_count=e.Answer.against_count-1,e.refreshAnswerList(e.answer_idx,"agree"))):(e.Answer.against_count=e.Answer.against_count+1,1==e.Answer.agree_status&&(e.Answer.agree_count=e.Answer.agree_count-1,e.refreshAnswerList(e.answer_idx,"against"))),e.Answer.agree_status=t}).catch(function(t){console.log("赞同 or 反对 回答失败",t)})},refreshAnswerList:function(t,e){if(t>-1){var n=getCurrentPages();if(n.length>1){var s=n[n.length-2],o=s.data.listData;console.log("listData",o),o.length>0&&("agree"==e?o[t].agree_count=o[t].agree_count+1:"against"==e?o[t].agree_count=o[t].agree_count-1:"comment"==e&&(o[t].comment_count=o[t].comment_count+1),s.setData({listData:o}))}}},CommentFormSubmit:function(t){var e=this,n=this.system_config;if(!n||"Y"==n.system_verify)return o.default.errorToast("小程序端暂不支持回复功能"),!1;console.log("CommentFormSubmit",t);var s=t.detail.value.message;if(!s||""==s)return o.default.errorToast("回答内容不能为空"),!1;var i=this.userInfo;if(!i.uid||i.uid<1||!this.hasLogin)return this.toLogin(),!1;var a={};a.access_token=i.access_token,a.answer_id=this.answer_id,a.message=s,this.$api.post_answer_comment(a).then(function(t){var n=t.data.rsm.item_id;n>0?(e.refreshAnswerList(e.answer_idx,"comment"),e.toAnswerDetail(n)):o.default.errorToast("系统异常，请返回")}).catch(function(t){console.log("提交回答失败",t)})},toAnswerDetail:function(e){console.log("toAnswerDetail",e),e>0?t.redirectTo({url:"../question/answer?question_id="+this.question_id+"&answer_id="+e}):o.default.showToast("回答ID有误")},hideCommentInput:function(e){t.setNavigationBarTitle({title:"查看评论"}),this.CommentInput=!1,this.showComment()},showCommentInput:function(){var e=this.system_config;if(!e||"Y"==e.system_verify)return o.default.errorToast("小程序端暂不支持回复功能"),!1;var n=this.userInfo;n.uid>0&&this.hasLogin?(this.showCommentList||this.showComment(),this.CommentInput=!0,t.setNavigationBarTitle({title:"写评论"})):t.navigateTo({url:"../account/login"})},showComment:function(){var e=this.showCommentList,n="";e?(this.showCommentList=!1,n="回答详情"):(this.Comments=this.listData,this.showCommentList=!0,n="查看评论"),""!=n&&t.setNavigationBarTitle({title:n})},toQuestionDetail:function(){var e=this.question_id;e>0?t.navigateTo({url:"detail?id="+e}):o.default.errorToast("问题ID有误")},toHome:function(){t.switchTab({url:"../index/index"})},toBack:function(){var e=getCurrentPages();e.length>1?t.navigateBack({delta:1}):this.toHome()},intGetList:function(){this.reload=!0,this.last_id=0,this.page=0,this.isLastPage=!1,this.getAnswerComments()},getQuestionAnswer:function(){var t=this,e=this.question_id,n=this.answer_id;if(e<1||n<1)return console.log("answer_id",n,"question_id",e),o.default.errorToast("获取问答信息失败"),!1;var s={},i=this.userInfo,a=this.page+1;s.page=a,s.question_id=e,s.answer_id=n,s.single=!0,s.access_token=i.access_token?i.access_token:"",s.sort_key=this.sort_key,this.$api.getQuestionAnswer(s).then(function(e){t.isLoad=!1,t.page=a;var n=e.data.rsm.list;console.log("list",n),n.length>0?(t.question_info=e.data.rsm.question_info,t.Answer=n[0],t.getAnswerComments()):(o.default.showToast("问答详情获取失败...."),t.isLoad=!0,t.isLastPage=!0)}).catch(function(t){console.log("请求失败，可以在这里写处理代码",t)})},getAnswerComments:function(){var e=this,n=this.question_id,s=this.answer_id;if(n<1||s<1)return o.default.errorToast("获取问答信息失败"),!1;var i={},a=(this.userInfo,this.page+1);if(i.page=a,i.answer_id=s,i.sort_key=this.sort_key,this.isLastPage)return t.stopPullDownRefresh(),this.isLoad=!0,o.default.showToast("没有更多回答了...."),!1;this.$api.getAnswerComments(i).then(function(t){e.isLoad=!1,e.page=a;var n=t.data.rsm.list;if(n.length>0){if(e.listData=e.reload?n:e.listData.concat(n),e.showCommentList||e.listData.length<2)e.Comments=e.listData;else{var s=e.listData,o=[],i=0;for(i=0;i<2;i++)o[i]=s[i];e.Comments=o,console.log("Comments",o)}e.reload=!1,n.length<10&&(e.isLoad=!0,e.isLastPage=!0)}else e.isLoad=!0,e.isLastPage=!0;n.length<1&&(e.footerTips="暂无评论")}).catch(function(t){console.log("请求失败，可以在这里写处理代码",t)})}}};e.default=u}).call(this,n("543d")["default"])},f0f4:function(t,e,n){"use strict";var s=n("fa96"),o=n.n(s);o.a},fa96:function(t,e,n){}},[["3087","common/runtime","common/vendor"]]]);